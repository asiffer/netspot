<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="stylesheet" type="text/css" href="/netspot/scss/style.css">
</head><body><div class="container-fluid banner">
  <nav class="container">
      <ul>
        
        <li class="netspot-mini"><strong>§2n|1</strong></li>
      </ul>
      <ul>
        
        <li><a href="/netspot/"><span>Home</span></a></li>
        
        <li><a href="/netspot/get-started/"><span>Get started</span></a></li>
        
        <li><a href="/netspot/download/"><span>Download</span></a></li>
        
        <li><a href="/netspot/advanced/"><span>Advanced</span></a></li>
        
        <li><a href="/netspot/developer/"><span>Developer</span></a></li>
        
      </ul>
  </nav>
</div><main class="container">
            <div class="toc">
                <aside class="container">
                    <nav>
                        <ul>
                        
                        
                        
                            
                                <li><a class="secondary" href="/netspot/get-started/basic/"><span>Basic usage</span></a></li>
                            
                        
                            
                                <li><a class="primary" href="/netspot/get-started/configuration/"><span>Configuration</span></a></li>
                            
                        
                            
                                <li><a class="secondary" href="/netspot/get-started/architecture/"><span>Architecture</span></a></li>
                            
                        
                        </ul>
                    </nav>
                </aside>
            </div>
            <div class="content">
            <h2>Configuration</h2>
            <p>The configuration of netspot follows its architecture.
There are three main sections: <code>miner</code>,
<code>analyzer</code> and <code>exporter</code>. In addition, there is the
<code>spot</code> section to configure the Spot algorithm.</p>
<ul>
<li><a href="#miner">Miner</a></li>
<li><a href="#analyzer">Analyzer</a></li>
<li><a href="#exporter">Exporter</a>
<ul>
<li><a href="#console">Console</a></li>
<li><a href="#file">File</a></li>
<li><a href="#socket">Socket</a></li>
<li><a href="#influxdb">InfluxDB</a></li>
</ul>
</li>
<li><a href="#spot">Spot</a></li>
</ul>
<h2 id="miner">Miner</h2>
<p>The miner is responsible of packet parsing. So you give it
all the necessary options to sniff either a network interface or
a pcap file.</p>
<p>The main parameter is <code>device</code> that defines the packets source .
By default, it is set to <code>&quot;any&quot;</code>, meaning that it sniffs all the
network interfaces.
In addition you will fins all the classical options you may pass
to <code>libpcap</code>.</p>
<div class="alert">
    You must take care of the <code>timeout</code> parameter. By default, it is set to <code>0s</code>, meaning that packets are directly sent to netspot. If this value is changed, you are likely to have a time lag in the statistics computation.
</div>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#998;font-style:italic"># the Miner module manages the packets parsing</span>
<span style="color:#998;font-style:italic"># and the counters</span>
[miner]
<span style="color:#998;font-style:italic"># name of the interface to listen or dump/pcap file path</span>
<span style="color:#998;font-style:italic">#device = &#34;any&#34;</span>
device = <span style="color:#b84">&#34;eth0&#34;</span>
<span style="color:#998;font-style:italic">#device = &#34;/tmp/file.pcap&#34;</span>
<span style="color:#998;font-style:italic"># interface only</span>
promiscuous = <span style="font-weight:bold">true</span>
snapshot_len = <span style="color:#099">65535</span>
<span style="color:#998;font-style:italic"># instant mode</span>
timeout = <span style="color:#b84">&#34;0s&#34;</span>
</code></pre></div><h2 id="analyzer">Analyzer</h2>
<p>The analyzer computes the statistics. So we only need to
set a list of statistics to monitor (parameter <code>stats</code>) and
to define the computation <code>period</code>.
The <code>period</code> is relative to the <code>device</code> netspot sniffs. If the <code>device</code> is a pcap file, the source of time is the
capture timestamps while it is the real time in the network interface case.</p>
<div class="info">
    You should set the <code>period</code> according to your device so as to make the stats computation relevant. For example, it is useless to set
a very low value like <code>1ms</code> if you have few packets a second.
In practice, you should tune
this parameter to ensure a rather <strong>low variance</strong> of the computed statistics (i.e. stable values).
</div>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#998;font-style:italic"># The Analyzer module manages the statistics</span>
<span style="color:#998;font-style:italic"># and send data to the exporter</span>
[analyzer]
<span style="color:#998;font-style:italic"># time between two statistics computations</span>
period = <span style="color:#b84">&#34;1s&#34;</span>
<span style="color:#998;font-style:italic"># stats to load at startup</span>
<span style="color:#998;font-style:italic">#stats = [&#34;AVG_PKT_SIZE&#34;]</span>
stats = [<span style="color:#b84">&#34;PERF&#34;</span>, <span style="color:#b84">&#34;R_SYN&#34;</span>, <span style="color:#b84">&#34;R_ACK&#34;</span>]
<span style="color:#998;font-style:italic">#stats = [</span>
<span style="color:#998;font-style:italic">#    &#34;PERF&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;R_ACK&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;R_ARP&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;R_DST_SRC&#34;,</span>
<span style="color:#998;font-style:italic">#    &#34;R_DST_SRC_PORT&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;R_ICMP&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;R_IP&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;R_SYN&#34;, </span>
<span style="color:#998;font-style:italic">#    &#34;TRAFFIC&#34;</span>
<span style="color:#998;font-style:italic">#]</span>
</code></pre></div><h2 id="exporter">Exporter</h2>
<p>The exporter dispatches statistics and alarms to
the desired backend.
The exporter gathers several basic modules like
the <code>console</code>, the <code>file</code> or the <code>socket</code>. In addition, netspot has also a module to send data
to <code>influxdb</code>.</p>
<p>For all the modules, you may notice that there are always two streams: data and alarms. You can
activate them independently.</p>
<h3 id="console">Console</h3>
<p>The configuration of this module could not be easier.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#998;font-style:italic"># The exporter print or send data according</span>
<span style="color:#998;font-style:italic"># to the loaded modules (and their options)</span>
<span style="color:#998;font-style:italic"># [exporter]</span>
[exporter.console]
<span style="color:#998;font-style:italic"># print data to the console</span>
data = <span style="font-weight:bold">true</span>
<span style="color:#998;font-style:italic"># print alarms to the console</span>
alarm = <span style="font-weight:bold">true</span>
</code></pre></div><h3 id="file">File</h3>
<p>The <code>file</code> module has a basic template. You can
add <code>%s</code> in the output file: this will be replaced by the name of the running series.
Data (and alarms) are stored as <code>json</code> records.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[exporter.file]
<span style="color:#998;font-style:italic"># Path to the file which will store the data.</span>
<span style="color:#998;font-style:italic"># The value can contain a &#39;%s&#39; which will be</span>
<span style="color:#998;font-style:italic"># replaced by the series name. </span>
data = <span style="color:#b84">&#34;/tmp/netspot_%s_data.json&#34;</span>
<span style="color:#998;font-style:italic"># Same as the data but for the alarms</span>
<span style="color:#998;font-style:italic">#alarm = &#34;/tmp/netspot_%s_alarm.json&#34;</span>
</code></pre></div><h3 id="socket">Socket</h3>
<p>The <code>socket</code> allows to send data in a &ldquo;generic way&rdquo;, meaning without setting the protocol upon.</p>
<p>In comparison to the above modules, you can add a <code>tag</code> into the sent data and change their format.
Currently three formats are supported: <code>csv</code>, <code>json</code> and <code>gob</code> (golang binary format).</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[exporter.socket]
<span style="color:#998;font-style:italic"># Path to the socket which will receive the data</span>
<span style="color:#998;font-style:italic"># The format is the following: &lt;proto&gt;://&lt;address&gt;</span>
data = <span style="color:#b84">&#34;unix:///tmp/netspot_data.socket&#34;</span>
<span style="color:#998;font-style:italic"># Path to the socket which will receive the alarms</span>
<span style="color:#998;font-style:italic"># The format is the following: &lt;proto&gt;://&lt;address&gt;</span>
alarm = <span style="color:#b84">&#34;unix:///tmp/netspot_alarm.socket&#34;</span>
<span style="color:#998;font-style:italic"># Additional tag when data are sent</span>
tag = <span style="color:#b84">&#34;netspot&#34;</span>
<span style="color:#998;font-style:italic"># Format of the data (accept csv, json or gob)</span>
format = <span style="color:#b84">&#34;json&#34;</span>
</code></pre></div><h3 id="influxdb">InfluxDB</h3>
<p>Finally, you can send netspot data to an <a href="https://www.influxdata.com/">InfluxDB</a> database (version <code>v1.x</code>).
Classically, you need to define the endpoint, some credentials and the name of the database.
Furthermore, for performance reasons, you can tune the <code>batch_size</code> (number of records to cache before sending).
Like in the <code>socket</code> module, you can define an <code>agent_name</code> which is a kind of tag
(it can be very convenient for InfluxDB).</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[exporter.influxdb1]
<span style="color:#998;font-style:italic">#data = true</span>
<span style="color:#998;font-style:italic">#alarm = true</span>
<span style="color:#998;font-style:italic">#address = &#34;http://127.0.0.1:8086&#34;</span>
<span style="color:#998;font-style:italic">#database = &#34;netspot&#34;</span>
<span style="color:#998;font-style:italic">#username = &#34;netspot&#34;</span>
<span style="color:#998;font-style:italic">#password = &#34;netspot&#34;</span>
<span style="color:#998;font-style:italic">#batch_size = 5</span>
<span style="color:#998;font-style:italic">#agent_name = &#34;local&#34;</span>
</code></pre></div><h2 id="spot">Spot</h2>
<p>The Spot section is specific to the configuration of the detection algorithm.
To well understand the parameters, we advise to look at the <a href="/advanced/spot/">Spot details</a>.
The parameters given in the <code>[spot]</code> section
are the default parameter of the Spot instances monitoring the network statistics.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#998;font-style:italic"># spot section manages the default spot parameters</span>
[spot]
<span style="color:#998;font-style:italic"># depth = 50</span>
<span style="color:#998;font-style:italic"># q = 1e-4</span>
<span style="color:#998;font-style:italic"># n_init = 1000</span>
<span style="color:#998;font-style:italic"># level = 0.98</span>
<span style="color:#998;font-style:italic"># up = true</span>
<span style="color:#998;font-style:italic"># down = false</span>
<span style="color:#998;font-style:italic"># alert = true</span>
<span style="color:#998;font-style:italic"># bounded = true</span>
<span style="color:#998;font-style:italic"># max_excess = 200</span>
</code></pre></div><p>However, you can define another Spot configuration
for some statistics. You only need to create a
section <code>[spot.STAT_NAME]</code> and overwrite some parameters.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#998;font-style:italic"># you can add a specific section for a statistic</span>
<span style="color:#998;font-style:italic"># it overrides the default values</span>
[spot.R_SYN]
q = <span style="color:#099">1</span>e<span style="color:#099">-5</span>
</code></pre></div>
            </div>
            
        </main>
       
    </body>
</html>
